<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-06-29T10:48:24.388177"><title>Chapitre 5 : Patterns Avanc&eacute;s - G&eacute;rer de Grands Ensembles de Donn&eacute;es (L'Essentiel) | Help Instance</title><script type="application/json" id="virtual-toc-data">[{"id":"objectifs-p-dagogiques","level":0,"title":"Objectifs Pédagogiques","anchor":"#objectifs-p-dagogiques"},{"id":"introduction-le-biblioth-caire-efficace","level":0,"title":"Introduction : Le Bibliothécaire Efficace","anchor":"#introduction-le-biblioth-caire-efficace"},{"id":"1-la-pagination-avec-spring-data-jpa","level":0,"title":"1. La Pagination avec Spring Data JPA","anchor":"#1-la-pagination-avec-spring-data-jpa"},{"id":"2-le-tri","level":0,"title":"2. Le Tri","anchor":"#2-le-tri"},{"id":"exercice-11-paginer-et-trier-les-auteurs","level":0,"title":"Exercice 11 : Paginer et Trier les Auteurs","anchor":"#exercice-11-paginer-et-trier-les-auteurs"},{"id":"correction-exercice-11","level":0,"title":"Correction exercice 11","anchor":"#correction-exercice-11"},{"id":"auto-valuation","level":0,"title":"Auto-évaluation","anchor":"#auto-valuation"},{"id":"conclusion","level":0,"title":"Conclusion","anchor":"#conclusion"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Chapitre 5 : Patterns Avanc&eacute;s - G&eacute;rer de Grands Ensembles de Donn&eacute;es (L'Essentiel) | Help Instance"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Help Instance Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/005-01-paging-and-sorting.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Chapitre 5 : Patterns Avanc&eacute;s - G&eacute;rer de Grands Ensembles de Donn&eacute;es (L'Essentiel) | Help Instance"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/005-01-paging-and-sorting.html#webpage",
    "url": "writerside-documentation/005-01-paging-and-sorting.html",
    "name": "Chapitre 5 : Patterns Avanc&eacute;s - G&eacute;rer de Grands Ensembles de Donn&eacute;es (L'Essentiel) | Help Instance",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Help Instance Help"
}</script><!-- End Schema.org --></head><body data-id="005-01-paging-and-sorting" data-main-title="Chapitre 5 : Patterns Avancés - Gérer de Grands Ensembles de Données (L'Essentiel)" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="004-00-advanced-rest-patterns.md|Chapitre 5 : Patterns REST Avancés - L'Essentiel"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Help Instance  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="005-01-paging-and-sorting" id="005-01-paging-and-sorting.md">Chapitre 5 : Patterns Avancés - Gérer de Grands Ensembles de Données (L'Essentiel)</h1><p id="z3mw4v0_3">Jusqu'&agrave; pr&eacute;sent, notre API &quot;BiblioTech&quot; fonctionne &agrave; merveille avec notre petit jeu de donn&eacute;es de test. Mais imaginez une vraie biblioth&egrave;que avec des dizaines de milliers de livres. Si un client appelle <code class="code" id="z3mw4v0_12">GET /api/books</code>, doit-on vraiment lui envoyer une r&eacute;ponse JSON de plusieurs m&eacute;gaoctets contenant 50 000 objets ? La r&eacute;ponse est un non retentissant. Cela saturerait le r&eacute;seau, ferait planter le navigateur du client et mettrait notre serveur &agrave; genoux. Il nous faut une strat&eacute;gie pour servir de grands ensembles de donn&eacute;es de mani&egrave;re intelligente.</p><section class="chapter"><h2 id="objectifs-p-dagogiques" data-toc="objectifs-p-dagogiques">Objectifs P&eacute;dagogiques</h2><p id="z3mw4v0_13">&Agrave; la fin de cette partie, vous serez capable de :</p><ul class="list _bullet" id="z3mw4v0_14"><li class="list__item" id="z3mw4v0_15"><p id="z3mw4v0_20">Comprendre les probl&egrave;mes li&eacute;s au retour de collections de donn&eacute;es trop volumineuses.</p></li><li class="list__item" id="z3mw4v0_16"><p id="z3mw4v0_21">Mettre en &oelig;uvre la pagination pour retourner les donn&eacute;es par &quot;pages&quot; ou &quot;morceaux&quot;.</p></li><li class="list__item" id="z3mw4v0_17"><p id="z3mw4v0_22">Utiliser l'objet <code class="code" id="z3mw4v0_23">Pageable</code> de Spring Data JPA pour simplifier la pagination.</p></li><li class="list__item" id="z3mw4v0_18"><p id="z3mw4v0_24">Impl&eacute;menter le tri pour permettre aux clients de classer les r&eacute;sultats selon leurs besoins.</p></li><li class="list__item" id="z3mw4v0_19"><p id="z3mw4v0_25">Interpr&eacute;ter la structure de r&eacute;ponse pagin&eacute;e fournie par Spring.</p></li></ul></section><section class="chapter"><h2 id="introduction-le-biblioth-caire-efficace" data-toc="introduction-le-biblioth-caire-efficace">Introduction : Le Biblioth&eacute;caire Efficace</h2><p id="z3mw4v0_26">Imaginez que vous demandez &agrave; un biblioth&eacute;caire &quot;tous les livres sur l'histoire&quot;. Un biblioth&eacute;caire inefficace commencerait &agrave; empiler des milliers de livres sur le comptoir jusqu'&agrave; ce qu'il s'effondre. Un biblioth&eacute;caire efficace, lui, vous dirait : &quot;Bien s&ucirc;r. Voici les 10 premiers, rang&eacute;s par ordre alphab&eacute;tique. Dites-moi si vous voulez voir les 10 suivants.&quot;</p><p id="z3mw4v0_27">Dans le monde des API, nous devons &ecirc;tre ce biblioth&eacute;caire efficace. La <span class="control" id="z3mw4v0_28">pagination</span> est la technique qui consiste &agrave; diviser une grande collection de r&eacute;sultats en plus petits morceaux (des pages). Le <span class="control" id="z3mw4v0_29">tri</span> est la capacit&eacute; &agrave; organiser les r&eacute;sultats de chaque page selon un crit&egrave;re pr&eacute;cis (par titre, par date, etc.). Spring Boot rend ces deux op&eacute;rations remarquablement simples.</p></section><section class="chapter"><h2 id="1-la-pagination-avec-spring-data-jpa" data-toc="1-la-pagination-avec-spring-data-jpa">1. La Pagination avec Spring Data JPA</h2><p id="z3mw4v0_30">L'&eacute;cosyst&egrave;me Spring Data nous offre un outil magique pour g&eacute;rer la pagination et le tri : l'interface <code class="code" id="z3mw4v0_34">Pageable</code>. En l'ajoutant simplement comme param&egrave;tre &agrave; une m&eacute;thode de contr&ocirc;leur, Spring va automatiquement chercher les param&egrave;tres de pagination dans l'URL de la requ&ecirc;te.</p><p id="z3mw4v0_31">Les param&egrave;tres standards sont :</p><ul class="list _bullet" id="z3mw4v0_32"><li class="list__item" id="z3mw4v0_35"><p id="z3mw4v0_37"><code class="code" id="z3mw4v0_38">page</code>: Le num&eacute;ro de la page que l'on souhaite r&eacute;cup&eacute;rer (commence &agrave; 0).</p></li><li class="list__item" id="z3mw4v0_36"><p id="z3mw4v0_39"><code class="code" id="z3mw4v0_40">size</code>: Le nombre d'&eacute;l&eacute;ments &agrave; inclure dans une page.</p></li></ul><section class="procedure-steps"><h3 id="z3mw4v0_33" data-toc="z3mw4v0_33">Ajout de la pagination au `BookController`</h3><p id="z3mw4v0_41">Modifions notre m&eacute;thode <code class="code" id="z3mw4v0_51">getAllBooks</code> (que nous avions transform&eacute;e en <code class="code" id="z3mw4v0_52">searchBooks</code>). Pour la clart&eacute;, revenons &agrave; un endpoint de base listant tous les livres, mais de mani&egrave;re pagin&eacute;e.</p><ol class="list _decimal" id="z3mw4v0_42" type="1"><li class="list__item" id="z3mw4v0_53"><p id="z3mw4v0_54"><span class="control" id="z3mw4v0_55">Le contr&ocirc;leur s'adapte</span></p></li></ol><div class="code-block" data-lang="java">
// Dans BookController.java

import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;

// ...

@Operation(summary = &quot;Récupère une liste paginée de livres&quot;)
@GetMapping
public Page&lt;BookDto&gt; getAllBooks(Pageable pageable) {
    // La méthode findAll(pageable) de Spring Data retourne directement
    // un objet Page. C'est tout ce qu'il y a à faire !
    Page&lt;Book&gt; bookPage = this.bookRepository.findAll(pageable);

    // On mappe la page d'entités en une page de DTOs.
    return bookPage.map(this.bookMapper::toDto);
}
</div><ol class="list _decimal" id="z3mw4v0_44" type="1" start="2"><li class="list__item" id="z3mw4v0_56"><p id="z3mw4v0_57"><span class="control" id="z3mw4v0_58">Tester avec une requ&ecirc;te HTTP</span></p></li></ol><p id="z3mw4v0_45">Essayons de r&eacute;cup&eacute;rer la premi&egrave;re page, avec 2 livres par page.</p><div class="code-block" data-lang="http">
### Récupérer la première page de livres (2 par page)
GET http://localhost:8080/api/books?page=0&amp;size=2
Accept: application/json
</div><ol class="list _decimal" id="z3mw4v0_47" type="1" start="3"><li class="list__item" id="z3mw4v0_59"><p id="z3mw4v0_60"><span class="control" id="z3mw4v0_61">Analyser la r&eacute;ponse</span></p></li></ol><p id="z3mw4v0_48">La r&eacute;ponse n'est plus un simple tableau JSON. C'est un objet JSON qui contient les donn&eacute;es de la page (<code class="code" id="z3mw4v0_62">content</code>) ainsi que les m&eacute;tadonn&eacute;es de pagination.</p><div class="code-block" data-lang="json">
{
  &quot;content&quot;: [
    {
      &quot;id&quot;: 1,
      &quot;title&quot;: &quot;Harry Potter and the Sorcerer's Stone&quot;,
      &quot;isbn&quot;: &quot;978-0439708180&quot;
      // ...
    },
    {
      &quot;id&quot;: 2,
      &quot;title&quot;: &quot;The Hobbit&quot;,
      &quot;isbn&quot;: &quot;978-0345339683&quot;
      // ...
    }
  ],
  &quot;pageable&quot;: {
    &quot;pageNumber&quot;: 0,
    &quot;pageSize&quot;: 2,
    &quot;sort&quot;: {
      &quot;unsorted&quot;: true,
      &quot;sorted&quot;: false,
      &quot;empty&quot;: true
    }
    // ...
  },
  &quot;totalPages&quot;: 2,
  // Il y a 2 pages au total
  &quot;totalElements&quot;: 3,
  // Il y a 3 livres au total dans la BDD
  &quot;last&quot;: false,
  // Ce n'est pas la dernière page
  &quot;size&quot;: 2,
  &quot;number&quot;: 0,
  // Numéro de la page actuelle
  &quot;numberOfElements&quot;: 2,
  // Nombre d'éléments sur cette page
  &quot;first&quot;: true,
  // C'est la première page
  &quot;empty&quot;: false
}
</div><p id="z3mw4v0_50">Ces m&eacute;tadonn&eacute;es sont extr&ecirc;mement utiles pour le client (par exemple, une application web) afin de construire une interface de pagination (ex: &quot;Page 1 sur 2&quot;, boutons &quot;Pr&eacute;c&eacute;dent&quot;/&quot;Suivant&quot;).</p><ol class="list _decimal"></ol></section></section><section class="chapter"><h2 id="2-le-tri" data-toc="2-le-tri">2. Le Tri</h2><p id="z3mw4v0_63">Le tri est un compagnon naturel de la pagination. Le client peut le sp&eacute;cifier via le param&egrave;tre de requ&ecirc;te <code class="code" id="z3mw4v0_68">sort</code>.</p><ul class="list _bullet" id="z3mw4v0_64"><li class="list__item" id="z3mw4v0_69"><p id="z3mw4v0_73">Le format est <code class="code" id="z3mw4v0_74">sort=propriete,direction</code>.</p></li><li class="list__item" id="z3mw4v0_70"><p id="z3mw4v0_75">Exemple : <code class="code" id="z3mw4v0_76">sort=title,asc</code> pour trier par titre en ordre ascendant.</p></li><li class="list__item" id="z3mw4v0_71"><p id="z3mw4v0_77">Exemple : <code class="code" id="z3mw4v0_78">sort=publicationDate,desc</code> pour trier par date de publication en ordre descendant.</p></li><li class="list__item" id="z3mw4v0_72"><p id="z3mw4v0_79">On peut m&ecirc;me combiner plusieurs crit&egrave;res : <code class="code" id="z3mw4v0_80">sort=lastName,asc&amp;sort=firstName,asc</code>.</p></li></ul><p id="z3mw4v0_65">Bonne nouvelle : nous n'avons <span class="control" id="z3mw4v0_81">rien &agrave; changer dans notre code</span>! L'objet <code class="code" id="z3mw4v0_82">Pageable</code> g&egrave;re le tri automatiquement.</p><section class="procedure-steps"><h3 id="z3mw4v0_66" data-toc="z3mw4v0_66">Tester le tri</h3><div class="code-block" data-lang="http">
### Récupérer les livres triés par titre (ascendant)
GET http://localhost:8080/api/books?size=5&amp;sort=title,asc

### Récupérer les livres triés par date de publication (plus récent d'abord)
GET http://localhost:8080/api/books?size=5&amp;sort=publicationDate,desc
</div><p id="z3mw4v0_84">Le serveur retournera les livres dans l'ordre demand&eacute;.</p><ol class="list _decimal"></ol></section></section><section class="chapter"><h2 id="exercice-11-paginer-et-trier-les-auteurs" data-toc="exercice-11-paginer-et-trier-les-auteurs">Exercice 11 : Paginer et Trier les Auteurs</h2><p id="z3mw4v0_88">Appliquez ces concepts &agrave; notre <code class="code" id="z3mw4v0_91">AuthorController</code>.</p><p id="z3mw4v0_89"><span class="control" id="z3mw4v0_92">&Eacute;nonc&eacute; :</span></p><ol class="list _decimal" id="z3mw4v0_90" type="1"><li class="list__item" id="z3mw4v0_93"><p id="z3mw4v0_97">Modifiez la m&eacute;thode <code class="code" id="z3mw4v0_98">getAllAuthors</code> dans <code class="code" id="z3mw4v0_99">AuthorController</code> pour qu'elle accepte un <code class="code" id="z3mw4v0_100">Pageable</code> en param&egrave;tre.</p></li><li class="list__item" id="z3mw4v0_94"><p id="z3mw4v0_101">La m&eacute;thode doit maintenant retourner un <code class="code" id="z3mw4v0_102">Page&lt;AuthorDto&gt;</code>.</p></li><li class="list__item" id="z3mw4v0_95"><p id="z3mw4v0_103">Utilisez <code class="code" id="z3mw4v0_104">authorRepository.findAll(pageable)</code> et mappez le r&eacute;sultat en <code class="code" id="z3mw4v0_105">Page&lt;AuthorDto&gt;</code>.</p></li><li class="list__item" id="z3mw4v0_96"><p id="z3mw4v0_106">Testez votre nouvel endpoint avec les requ&ecirc;tes suivantes :</p><ul class="list _bullet" id="z3mw4v0_107"><li class="list__item" id="z3mw4v0_108"><p id="z3mw4v0_110">R&eacute;cup&eacute;rer la premi&egrave;re page de 1 auteur.</p></li><li class="list__item" id="z3mw4v0_109"><p id="z3mw4v0_111">R&eacute;cup&eacute;rer tous les auteurs (en utilisant une taille de page assez grande) tri&eacute;s par nom de famille en ordre descendant (<code class="code" id="z3mw4v0_112">lastName,desc</code>).</p></li></ul></li></ol></section><section class="chapter"><div class="collapse"><div class="collapse__title"><h2 id="correction-exercice-11" data-toc="correction-exercice-11">Correction exercice 11</h2></div><div class="collapse__content"><p id="z3mw4v0_113"><span class="control" id="z3mw4v0_118">1, 2, 3. <code class="code" id="z3mw4v0_119">AuthorController.java</code> modifi&eacute;</span></p><div class="code-block" data-lang="java">
// package fr.formation.spring.bibliotech.api;

import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;
// ...

@RestController
@RequestMapping(&quot;/api/authors&quot;)
public class AuthorController {
    // ...

    @Operation(summary = &quot;Récupère une liste paginée d'auteurs&quot;)
    @GetMapping
    public Page&lt;AuthorDto&gt; getAllAuthors(Pageable pageable) {
        return this.authorRepository.findAll(pageable)
                .map(this.authorMapper::toDto);
    }
    // ...
}
</div><p id="z3mw4v0_115"><span class="control" id="z3mw4v0_120">4. Requ&ecirc;tes de test</span></p><div class="code-block" data-lang="http">
### Récupérer la première page de 1 auteur
GET http://localhost:8080/api/authors?page=0&amp;size=1

### Récupérer les auteurs triés par nom de famille (Z-&gt;A)
GET http://localhost:8080/api/authors?size=5&amp;sort=lastName,desc
</div><p id="z3mw4v0_117">Vous devriez obtenir des r&eacute;ponses JSON structur&eacute;es avec l'objet <code class="code" id="z3mw4v0_121">Page</code>, contenant les auteurs demand&eacute;s dans le bon ordre.</p></div></div></section><section class="chapter"><h2 id="auto-valuation" data-toc="auto-valuation">Auto-&eacute;valuation</h2><ol class="list _decimal" id="z3mw4v0_122" type="1"><li class="list__item" id="z3mw4v0_123"><p id="z3mw4v0_128"><span class="control" id="z3mw4v0_129">(QCM)</span> Quel objet Spring faut-il ajouter comme param&egrave;tre de m&eacute;thode dans un contr&ocirc;leur pour activer la pagination et le tri ? a) <code class="code" id="z3mw4v0_130">Pagination</code> b) <code class="code" id="z3mw4v0_131">PageRequest</code> c) <code class="code" id="z3mw4v0_132">Pageable</code> d) <code class="code" id="z3mw4v0_133">Sortable</code></p></li><li class="list__item" id="z3mw4v0_124"><p id="z3mw4v0_134"><span class="control" id="z3mw4v0_135">_ (Question ouverte)_</span> Citez deux raisons pour lesquelles il est indispensable de paginer les r&eacute;ponses d'API qui retournent de grandes collections.</p></li><li class="list__item" id="z3mw4v0_125"><p id="z3mw4v0_136"><span class="control" id="z3mw4v0_137">(QCM)</span> Dans une r&eacute;ponse pagin&eacute;e de Spring Data, o&ugrave; se trouve le tableau des donn&eacute;es de la page actuelle ? a) Dans le champ <code class="code" id="z3mw4v0_138">data</code>. b) Dans le champ <code class="code" id="z3mw4v0_139">content</code>. c) Dans le champ <code class="code" id="z3mw4v0_140">page</code>. d) &Agrave; la racine de l'objet JSON.</p></li><li class="list__item" id="z3mw4v0_126"><p id="z3mw4v0_141"><span class="control" id="z3mw4v0_142">_ (Question ouverte)_</span> Quelle est la syntaxe du param&egrave;tre de requ&ecirc;te pour demander la troisi&egrave;me page de r&eacute;sultats, avec 10 &eacute;l&eacute;ments par page ?</p></li><li class="list__item" id="z3mw4v0_127"><p id="z3mw4v0_143"><span class="control" id="z3mw4v0_144">_ (Question ouverte)_</span> Comment demanderiez-vous &agrave; l'API de trier les r&eacute;sultats par pr&eacute;nom (<code class="code" id="z3mw4v0_145">firstName</code>) en ordre ascendant, puis par nom de famille (<code class="code" id="z3mw4v0_146">lastName</code>) en ordre descendant ?</p></li></ol></section><section class="chapter"><h2 id="conclusion" data-toc="conclusion">Conclusion</h2><p id="z3mw4v0_147">Vous venez de doter votre API d'une capacit&eacute; essentielle pour g&eacute;rer des applications du monde r&eacute;el. En ma&icirc;trisant la pagination et le tri, vous garantissez que votre API reste performante et utilisable, m&ecirc;me avec des millions d'enregistrements. Vous savez maintenant comment servir des donn&eacute;es de mani&egrave;re efficace et comment donner au client le contr&ocirc;le sur la fa&ccedil;on dont il les re&ccedil;oit.</p><p id="z3mw4v0_148">Cependant, la vie d'une API ne s'arr&ecirc;te pas &agrave; sa premi&egrave;re version. Elle va &eacute;voluer. Comment g&eacute;rer ces &eacute;volutions sans casser les applications qui l'utilisent ? Et comment rendre l'API encore plus &quot;intelligente&quot; pour guider le client ? C'est ce que nous verrons dans la partie suivante avec le versioning et HATEOAS.</p></section><div class="last-modified">29 juin 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="004-00-advanced-rest-patterns.html" class="navigation-links__prev">Chapitre 5 : Patterns REST Avanc&eacute;s - L'Essentiel</a><a href="005-01-hateoas.html" class="navigation-links__next">Chapitre 5 : L'API Auto-d&eacute;couvrable avec HATEOAS - Pour aller plus loin</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>