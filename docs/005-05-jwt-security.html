<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-06-29T10:48:24.284918"><title>Chapitre 5 : S&eacute;curisation de l'API avec JWT - L'Authentification Moderne | Help Instance</title><script type="application/json" id="virtual-toc-data">[{"id":"objectifs-p-dagogiques","level":0,"title":"Objectifs Pédagogiques","anchor":"#objectifs-p-dagogiques"},{"id":"introduction-la-carte-d-identit-num-rique","level":0,"title":"Introduction : La Carte d\u0027Identité Numérique","anchor":"#introduction-la-carte-d-identit-num-rique"},{"id":"1-qu-est-ce-qu-un-jwt","level":0,"title":"1. Qu\u0027est-ce qu\u0027un JWT ?","anchor":"#1-qu-est-ce-qu-un-jwt"},{"id":"2-int-gration-de-spring-security-et-jwt","level":0,"title":"2. Intégration de Spring Security et JWT","anchor":"#2-int-gration-de-spring-security-et-jwt"},{"id":"3-la-cha-ne-de-configuration-de-s-curit","level":0,"title":"3. La Chaîne de Configuration de Sécurité","anchor":"#3-la-cha-ne-de-configuration-de-s-curit"},{"id":"4-le-processus-d-authentification","level":0,"title":"4. Le Processus d\u0027Authentification","anchor":"#4-le-processus-d-authentification"},{"id":"5-le-code-de-s-curit-complet","level":0,"title":"5. Le code de sécurité complet","anchor":"#5-le-code-de-s-curit-complet"},{"id":"exercice-15-mettre-en-place-une-r-gle-de-s-curit","level":0,"title":"Exercice 15 : Mettre en Place une Règle de Sécurité","anchor":"#exercice-15-mettre-en-place-une-r-gle-de-s-curit"},{"id":"exercice-15-affiner-les-autorisations-par-r-le","level":0,"title":"Exercice 15 : Affiner les Autorisations par Rôle","anchor":"#exercice-15-affiner-les-autorisations-par-r-le"},{"id":"correction-exercice-15","level":0,"title":"Correction exercice 15","anchor":"#correction-exercice-15"},{"id":"conclusion","level":0,"title":"Conclusion","anchor":"#conclusion"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Chapitre 5 : S&eacute;curisation de l'API avec JWT - L'Authentification Moderne | Help Instance"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Help Instance Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/005-05-jwt-security.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Chapitre 5 : S&eacute;curisation de l'API avec JWT - L'Authentification Moderne | Help Instance"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/005-05-jwt-security.html#webpage",
    "url": "writerside-documentation/005-05-jwt-security.html",
    "name": "Chapitre 5 : S&eacute;curisation de l'API avec JWT - L'Authentification Moderne | Help Instance",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Help Instance Help"
}</script><!-- End Schema.org --></head><body data-id="005-05-JWT-security" data-main-title="Chapitre 5 : Sécurisation de l'API avec JWT - L'Authentification Moderne" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="004-00-advanced-rest-patterns.md|Chapitre 5 : Patterns REST Avancés - L'Essentiel"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Help Instance  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="005-05-JWT-security" id="005-05-JWT-security.md">Chapitre 5 : Sécurisation de l'API avec JWT - L'Authentification Moderne</h1><p id="-lrg8ux_3">Nous avons mis en place une premi&egrave;re serrure avec une cl&eacute; d'API. C'est efficace, mais c'est une cl&eacute; unique pour tout le monde. Comment faire si nous voulons savoir <span class="control" id="-lrg8ux_15">qui</span> utilise notre API ? Comment donner des droits diff&eacute;rents &agrave; un simple lecteur et &agrave; un biblioth&eacute;caire administrateur ? Il nous faut une carte d'identit&eacute; infalsifiable, pas juste un passe-partout. Bienvenue dans le monde de l'authentification par <span class="control" id="-lrg8ux_16">JSON Web Token (JWT)</span>.</p><section class="chapter"><h2 id="objectifs-p-dagogiques" data-toc="objectifs-p-dagogiques">Objectifs P&eacute;dagogiques</h2><p id="-lrg8ux_17">&Agrave; la fin de cette partie, vous serez capable de :</p><ul class="list _bullet" id="-lrg8ux_18"><li class="list__item" id="-lrg8ux_19"><p id="-lrg8ux_24">Comprendre la structure et le fonctionnement d'un JSON Web Token (JWT).</p></li><li class="list__item" id="-lrg8ux_20"><p id="-lrg8ux_25">Int&eacute;grer Spring Security dans votre projet pour une gestion robuste de la s&eacute;curit&eacute;.</p></li><li class="list__item" id="-lrg8ux_21"><p id="-lrg8ux_26">Cr&eacute;er un endpoint d'authentification qui d&eacute;livre un JWT en &eacute;change d'un identifiant et d'un mot de passe.</p></li><li class="list__item" id="-lrg8ux_22"><p id="-lrg8ux_27">Configurer une cha&icirc;ne de filtres de s&eacute;curit&eacute; pour valider les JWTs sur les requ&ecirc;tes entrantes.</p></li><li class="list__item" id="-lrg8ux_23"><p id="-lrg8ux_28">Prot&eacute;ger des endpoints sp&eacute;cifiques et n'autoriser leur acc&egrave;s qu'aux utilisateurs authentifi&eacute;s.</p></li></ul></section><section class="chapter"><h2 id="introduction-la-carte-d-identit-num-rique" data-toc="introduction-la-carte-d-identit-num-rique">Introduction : La Carte d'Identit&eacute; Num&eacute;rique</h2><p id="-lrg8ux_29">La cl&eacute; d'API &eacute;tait un passe de club priv&eacute; : elle prouve que vous avez le droit d'entrer, mais pas qui vous &ecirc;tes. Un JWT, c'est diff&eacute;rent. C'est une <span class="control" id="-lrg8ux_31">carte d'identit&eacute; num&eacute;rique</span>. Quand vous la pr&eacute;sentez, le serveur sait non seulement que vous avez le droit d'entrer (elle est valide), mais aussi que vous &ecirc;tes, par exemple, &quot;Jean Dupont, Administrateur&quot;.</p><p id="-lrg8ux_30">L'avantage majeur est qu'elle est <span class="control" id="-lrg8ux_32">stateless</span> et <span class="control" id="-lrg8ux_33">infalsifiable</span>. Le serveur n'a pas besoin de garder une copie de votre session. Toutes les informations n&eacute;cessaires (qui vous &ecirc;tes, vos droits, sa date d'expiration) sont contenues dans le token lui-m&ecirc;me, et une signature cryptographique garantit que personne ne l'a modifi&eacute; en chemin.</p></section><section class="chapter"><h2 id="1-qu-est-ce-qu-un-jwt" data-toc="1-qu-est-ce-qu-un-jwt">1. Qu'est-ce qu'un JWT ?</h2><p id="-lrg8ux_34">Un JWT est une cha&icirc;ne de caract&egrave;res compacte, compos&eacute;e de trois parties s&eacute;par&eacute;es par des points : <code class="code" id="-lrg8ux_36">xxxxx.yyyyy.zzzzz</code></p><ol class="list _decimal" id="-lrg8ux_35" type="1"><li class="list__item" id="-lrg8ux_37"><p id="-lrg8ux_40"><span class="control" id="-lrg8ux_41">Header (En-t&ecirc;te)</span>: Contient les m&eacute;tadonn&eacute;es. Typiquement, le type de token (<code class="code" id="-lrg8ux_42">JWT</code>) et l'algorithme de signature utilis&eacute; (<code class="code" id="-lrg8ux_43">HS256</code>).</p></li><li class="list__item" id="-lrg8ux_38"><p id="-lrg8ux_44"><span class="control" id="-lrg8ux_45">Payload (Donn&eacute;es utiles)</span>: Contient les &quot;claims&quot; (les informations). C'est le c&oelig;ur du token. On y trouve des informations standardis&eacute;es comme <code class="code" id="-lrg8ux_46">sub</code> (le sujet, ex: l'identifiant de l'utilisateur), <code class="code" id="-lrg8ux_47">exp</code> (la date d'expiration), et on peut y ajouter des informations personnalis&eacute;es comme les r&ocirc;les de l'utilisateur.</p></li><li class="list__item" id="-lrg8ux_39"><p id="-lrg8ux_48"><span class="control" id="-lrg8ux_49">Signature</span>: C'est le sceau de s&eacute;curit&eacute;. Elle est calcul&eacute;e &agrave; partir du Header, du Payload et d'une <span class="control" id="-lrg8ux_50">cl&eacute; secr&egrave;te</span> connue uniquement du serveur. Si quelqu'un modifie le Header ou le Payload, la signature ne correspondra plus, et le token sera rejet&eacute;.</p></li></ol></section><section class="chapter"><h2 id="2-int-gration-de-spring-security-et-jwt" data-toc="2-int-gration-de-spring-security-et-jwt">2. Int&eacute;gration de Spring Security et JWT</h2><p id="-lrg8ux_51">Pour g&eacute;rer tout cela, nous avons besoin de deux outils : Spring Security et une biblioth&egrave;que pour manipuler les JWTs.</p><section class="procedure-steps"><h3 id="-lrg8ux_52" data-toc="-lrg8ux_52">Mise à jour du `pom.xml`</h3><p>Ajoutez les d&eacute;pendances suivantes &agrave; votre projet. </p><div class="code-block" data-lang="markup">
&lt;!-- Dans la section &lt;dependencies&gt; --&gt;

&lt;!-- Spring Boot Starter pour la sécurité --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;
&lt;/dependency&gt;

        &lt;!-- Bibliothèque pour la création et validation des JWTs --&gt;
&lt;dependency&gt;
&lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;
&lt;artifactId&gt;jjwt-api&lt;/artifactId&gt;
&lt;version&gt;0.11.5&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
&lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;
&lt;artifactId&gt;jjwt-impl&lt;/artifactId&gt;
&lt;version&gt;0.11.5&lt;/version&gt;
&lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
&lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;
&lt;artifactId&gt;jjwt-jackson&lt;/artifactId&gt;
&lt;version&gt;0.11.5&lt;/version&gt;
&lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;
</div><p id="-lrg8ux_54">D&eacute;sormais, tous vos endpoints sont prot&eacute;g&eacute;s par d&eacute;faut ! Si vous relancez l'application, vous ne pourrez plus y acc&eacute;der. Nous allons maintenant configurer cet acc&egrave;s.</p><ol class="list _decimal"></ol></section></section><section class="chapter"><h2 id="3-la-cha-ne-de-configuration-de-s-curit" data-toc="3-la-cha-ne-de-configuration-de-s-curit">3. La Cha&icirc;ne de Configuration de S&eacute;curit&eacute;</h2><p id="-lrg8ux_55">C'est ici que nous allons d&eacute;finir les r&egrave;gles du jeu : quels endpoints sont publics, lesquels sont prot&eacute;g&eacute;s, et comment nous validons les tokens.</p><section class="procedure-steps"><h3 id="-lrg8ux_56" data-toc="-lrg8ux_56">Création de la classe `SecurityConfig.java`</h3><p>Cr&eacute;ez cette classe dans votre package `config`. </p><div class="code-block" data-lang="java">
// package fr.formation.spring.bibliotech.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.core.userdetails.User;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.provisioning.InMemoryUserDetailsManager;
import org.springframework.security.web.SecurityFilterChain;

@Configuration
@EnableWebSecurity
public class SecurityConfig {

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
                // Désactiver CSRF car nous utilisons une API stateless
                .csrf(csrf -&gt; csrf.disable())

                // Définir la politique de gestion de session comme stateless
                .sessionManagement(session -&gt;
                        session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))

                // Définir les autorisations pour les requêtes HTTP
                .authorizeHttpRequests(auth -&gt; auth
                        // Autoriser l'accès public aux endpoints de documentation
                        .requestMatchers(&quot;/swagger-ui/**&quot;, &quot;/v3/api-docs/**&quot;).permitAll()
                        // Autoriser l'accès public à la console H2
                        .requestMatchers(&quot;/h2-console/**&quot;).permitAll()
                        // Pour l'instant, autoriser les autres, nous affinerons plus tard
                        .anyRequest().permitAll()
                );

        // Permettre l'affichage de la console H2 dans un iFrame
        http.headers(headers -&gt; headers.frameOptions(frame -&gt; frame.sameOrigin()));

        return http.build();
    }

    // Bean pour encoder les mots de passe
    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }

    // Bean pour définir des utilisateurs en mémoire (pour l'exemple)
    @Bean
    public UserDetailsService userDetailsService() {
        UserDetails admin = User.builder()
                .username(&quot;admin&quot;)
                .password(passwordEncoder().encode(&quot;password123&quot;))
                .roles(&quot;ADMIN&quot;, &quot;USER&quot;)
                .build();

        UserDetails user = User.builder()
                .username(&quot;user&quot;)
                .password(passwordEncoder().encode(&quot;password&quot;))
                .roles(&quot;USER&quot;)
                .build();

        return new InMemoryUserDetailsManager(admin, user);
    }
}
</div><ol class="list _decimal"></ol></section><aside class="prompt" data-type="note" data-title="Pourquoi des utilisateurs en mémoire ?" id="-lrg8ux_57"><p id="-lrg8ux_60">Dans une application r&eacute;elle, vous cr&eacute;eriez une entit&eacute; <code class="code" id="-lrg8ux_61">User</code> en base de donn&eacute;es et impl&eacute;menteriez l'interface <code class="code" id="-lrg8ux_62">UserDetailsService</code> pour charger les utilisateurs depuis votre <code class="code" id="-lrg8ux_63">UserRepository</code>. Pour ce cours, utiliser des utilisateurs en m&eacute;moire (<code class="code" id="-lrg8ux_64">InMemoryUserDetailsManager</code>) nous permet de nous concentrer sur la logique JWT sans complexifier le mod&egrave;le de donn&eacute;es.</p></aside><p id="-lrg8ux_58">Pour l'instant, cette configuration ne fait pas grand-chose de plus que de d&eacute;finir des utilisateurs. Nous allons maintenant cr&eacute;er un endpoint pour s'authentifier et un filtre pour valider les tokens.</p></section><section class="chapter"><h2 id="4-le-processus-d-authentification" data-toc="4-le-processus-d-authentification">4. Le Processus d'Authentification</h2><p id="-lrg8ux_65">Nous avons besoin :</p><ol class="list _decimal" id="-lrg8ux_66" type="1"><li class="list__item" id="-lrg8ux_72"><p id="-lrg8ux_75">D'un <span class="control" id="-lrg8ux_76">endpoint</span> <code class="code" id="-lrg8ux_77">/api/auth/login</code> pour recevoir les identifiants.</p></li><li class="list__item" id="-lrg8ux_73"><p id="-lrg8ux_78">D'un <span class="control" id="-lrg8ux_79">service</span> <code class="code" id="-lrg8ux_80">JwtService</code> pour g&eacute;n&eacute;rer les tokens.</p></li><li class="list__item" id="-lrg8ux_74"><p id="-lrg8ux_81">D'un <span class="control" id="-lrg8ux_82">filtre</span> <code class="code" id="-lrg8ux_83">JwtAuthFilter</code> pour valider les tokens sur les autres requ&ecirc;tes.</p></li></ol><p id="-lrg8ux_67"><span class="control" id="-lrg8ux_84">L'id&eacute;e g&eacute;n&eacute;rale est la suivante :</span></p><ol class="list _decimal" id="-lrg8ux_68" type="1"><li class="list__item" id="-lrg8ux_85"><p id="-lrg8ux_89">Le client envoie une requ&ecirc;te <code class="code" id="-lrg8ux_90">POST /api/auth/login</code> avec un <code class="code" id="-lrg8ux_91">username</code> et <code class="code" id="-lrg8ux_92">password</code>.</p></li><li class="list__item" id="-lrg8ux_86"><p id="-lrg8ux_93">Un contr&ocirc;leur d'authentification utilise l' <code class="code" id="-lrg8ux_94">AuthenticationManager</code> de Spring pour v&eacute;rifier ces identifiants.</p></li><li class="list__item" id="-lrg8ux_87"><p id="-lrg8ux_95">Si l'authentification r&eacute;ussit, il appelle le <code class="code" id="-lrg8ux_96">JwtService</code> pour cr&eacute;er un token.</p></li><li class="list__item" id="-lrg8ux_88"><p id="-lrg8ux_97">Il retourne ce token au client.</p></li></ol><p id="-lrg8ux_69"><span class="control" id="-lrg8ux_98">Ensuite, pour chaque requ&ecirc;te sur un endpoint prot&eacute;g&eacute; :</span></p><ol class="list _decimal" id="-lrg8ux_70" type="1"><li class="list__item" id="-lrg8ux_99"><p id="-lrg8ux_103">Le <code class="code" id="-lrg8ux_104">JwtAuthFilter</code> intercepte la requ&ecirc;te.</p></li><li class="list__item" id="-lrg8ux_100"><p id="-lrg8ux_105">Il extrait le token de l'en-t&ecirc;te <code class="code" id="-lrg8ux_106">Authorization: Bearer &lt;token&gt;</code>.</p></li><li class="list__item" id="-lrg8ux_101"><p id="-lrg8ux_107">Il utilise le <code class="code" id="-lrg8ux_108">JwtService</code> pour valider la signature et l'expiration du token.</p></li><li class="list__item" id="-lrg8ux_102"><p id="-lrg8ux_109">S'il est valide, il cr&eacute;e un objet d'authentification et le place dans le <code class="code" id="-lrg8ux_110">SecurityContextHolder</code>. Spring Security sait alors que la requ&ecirc;te est valide et la laisse passer jusqu'au contr&ocirc;leur.</p></li></ol><style>.theme-dark .plantuml > svg {filter: hue-rotate(180deg) invert(0.9);}div.plantuml {overflow-x: auto;}</style><div class="plantuml"><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="794px" preserveAspectRatio="none" style="width:882px;height:794px;background:#FFFFFF;" version="1.1" viewBox="0 0 882 794" width="882px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="300" x="292.5" y="28.5352">Flux d'Authentification et d'Acc&#232;s Prot&#233;g&#233;</text><rect fill="#DDDDDD" height="744.5215" style="stroke:#181818;stroke-width:0.5;" width="651" x="136.5" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="133" x="395.5" y="56.0566">Serveur Spring Boot</text><rect fill="#FFFFFF" height="145.5527" style="stroke:#181818;stroke-width:1.0;" width="10" x="199" y="189.9082"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="359" y="261.5293"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="359" y="481.6582"/><rect fill="#FFFFFF" height="231.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="481" y="452.3477"/><rect fill="#FFFFFF" height="71.6211" style="stroke:#181818;stroke-width:1.0;" width="10" x="715" y="582.5898"/><rect fill="none" height="207.4844" style="stroke:#000000;stroke-width:1.5;" width="405" x="10" y="135.9766"/><rect fill="none" height="293.1055" style="stroke:#000000;stroke-width:1.5;" width="866" x="10" y="398.416"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="43" x2="43" y1="118.9766" y2="350.4609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="43" x2="43" y1="350.4609" y2="391.416"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="43" x2="43" y1="391.416" y2="708.5215"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="203.5" x2="203.5" y1="118.9766" y2="350.4609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="203.5" x2="203.5" y1="350.4609" y2="391.416"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="203.5" x2="203.5" y1="391.416" y2="708.5215"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="364" x2="364" y1="118.9766" y2="350.4609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="364" x2="364" y1="350.4609" y2="391.416"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="364" x2="364" y1="391.416" y2="708.5215"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="486" x2="486" y1="118.9766" y2="350.4609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="486" x2="486" y1="350.4609" y2="391.416"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="486" x2="486" y1="391.416" y2="708.5215"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="719.5" x2="719.5" y1="118.9766" y2="350.4609"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="719.5" x2="719.5" y1="350.4609" y2="391.416"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="719.5" x2="719.5" y1="391.416" y2="708.5215"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="20" y="116.0234">Client</text><ellipse cx="43" cy="50.9883" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M43,58.9883 L43,85.9883 M30,66.9883 L56,66.9883 M43,85.9883 L30,100.9883 M43,85.9883 L56,100.9883 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="20" y="721.0566">Client</text><ellipse cx="43" cy="732.5098" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M43,740.5098 L43,767.5098 M30,748.5098 L56,748.5098 M43,767.5098 L30,782.5098 M43,767.5098 L56,782.5098 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127" x="140.5" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="113" x="147.5" y="91.5352">&#171;RestController&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="152.5" y="108.0234">AuthController</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127" x="140.5" y="707.5215"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="113" x="147.5" y="728.0566">&#171;RestController&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="152.5" y="744.5449">AuthController</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82" x="323" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="62" x="333" y="91.5352">&#171;Service&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="330" y="108.0234">JwtService</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82" x="323" y="707.5215"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="62" x="333" y="728.0566">&#171;Service&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="330" y="744.5449">JwtService</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="102" x="435" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="49" x="461.5" y="91.5352">&#171;Filter&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="442" y="108.0234">JwtAuthFilter</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="102" x="435" y="707.5215"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="49" x="461.5" y="728.0566">&#171;Filter&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="442" y="744.5449">JwtAuthFilter</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127" x="656.5" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="113" x="663.5" y="91.5352">&#171;RestController&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="668" y="108.0234">BookController</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127" x="656.5" y="707.5215"/><text fill="#000000" font-family="sans-serif" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="113" x="663.5" y="728.0566">&#171;RestController&#187;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="668" y="744.5449">BookController</text><rect fill="#FFFFFF" height="145.5527" style="stroke:#181818;stroke-width:1.0;" width="10" x="199" y="189.9082"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="359" y="261.5293"/><rect fill="#FFFFFF" height="29.3105" style="stroke:#181818;stroke-width:1.0;" width="10" x="359" y="481.6582"/><rect fill="#FFFFFF" height="231.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="481" y="452.3477"/><rect fill="#FFFFFF" height="71.6211" style="stroke:#181818;stroke-width:1.0;" width="10" x="715" y="582.5898"/><path d="M10,135.9766 L228,135.9766 L228,143.2871 L218,153.2871 L10,153.2871 L10,135.9766 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="207.4844" style="stroke:#000000;stroke-width:1.5;" width="405" x="10" y="135.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="173" x="25" y="149.5449">Phase 1 : Authentification</text><polygon fill="#181818" points="187,185.9082,197,189.9082,187,193.9082,191,189.9082" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="43" x2="193" y1="189.9082" y2="189.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="50" y="169.8555">POST /api/auth/login</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="50" y="185.166">(user, pass)</text><line style="stroke:#181818;stroke-width:1.0;" x1="209" x2="251" y1="219.2188" y2="219.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="251" x2="251" y1="219.2188" y2="232.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="210" x2="251" y1="232.2188" y2="232.2188"/><polygon fill="#181818" points="220,228.2188,210,232.2188,220,236.2188,216,232.2188" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="216" y="214.4766">Valide les identifiants</text><polygon fill="#181818" points="347,257.5293,357,261.5293,347,265.5293,351,261.5293" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="209" x2="353" y1="261.5293" y2="261.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="216" y="256.7871">G&#233;n&#232;re un token</text><polygon fill="#181818" points="220,286.8398,210,290.8398,220,294.8398,216,290.8398" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="214" x2="363" y1="290.8398" y2="290.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="226" y="286.0977">JWT</text><polygon fill="#181818" points="54,331.4609,44,335.4609,54,339.4609,50,335.4609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="48" x2="203" y1="335.4609" y2="335.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="60" y="315.4082">R&#233;ponse (200 OK)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="60" y="330.7188">{ "token": "xxxxx..." }</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="111" x="326" y="375.0957">15 minutes plus tard</text><path d="M10,398.416 L335,398.416 L335,405.7266 L325,415.7266 L10,415.7266 L10,398.416 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="293.1055" style="stroke:#000000;stroke-width:1.5;" width="866" x="10" y="398.416"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="280" x="25" y="411.9844">Phase 2 : Acc&#232;s &#224; une ressource prot&#233;g&#233;e</text><polygon fill="#181818" points="469,448.3477,479,452.3477,469,456.3477,473,452.3477" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="43" x2="475" y1="452.3477" y2="452.3477"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="50" y="432.2949">DELETE /api/v1/books/1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="240" x="50" y="447.6055">Header: Authorization: Bearer xxxxx...</text><polygon fill="#181818" points="380,477.6582,370,481.6582,380,485.6582,376,481.6582" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="374" x2="480" y1="481.6582" y2="481.6582"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="386" y="476.916">Valide le token</text><polygon fill="#181818" points="469,506.9688,479,510.9688,469,514.9688,473,510.9688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="364" x2="475" y1="510.9688" y2="510.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="371" y="506.2266">Validation OK</text><line style="stroke:#181818;stroke-width:1.0;" x1="491" x2="533" y1="540.2793" y2="540.2793"/><line style="stroke:#181818;stroke-width:1.0;" x1="533" x2="533" y1="540.2793" y2="553.2793"/><line style="stroke:#181818;stroke-width:1.0;" x1="492" x2="533" y1="553.2793" y2="553.2793"/><polygon fill="#181818" points="502,549.2793,492,553.2793,502,557.2793,498,553.2793" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="498" y="535.5371">Met &#224; jour le contexte de s&#233;curit&#233;</text><polygon fill="#181818" points="703,578.5898,713,582.5898,703,586.5898,707,582.5898" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="491" x2="709" y1="582.5898" y2="582.5898"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="498" y="577.8477">Laisse passer la requ&#234;te</text><line style="stroke:#181818;stroke-width:1.0;" x1="725" x2="767" y1="611.9004" y2="611.9004"/><line style="stroke:#181818;stroke-width:1.0;" x1="767" x2="767" y1="611.9004" y2="624.9004"/><line style="stroke:#181818;stroke-width:1.0;" x1="726" x2="767" y1="624.9004" y2="624.9004"/><polygon fill="#181818" points="736,620.9004,726,624.9004,736,628.9004,732,624.9004" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="732" y="607.1582">Traite la suppression</text><polygon fill="#181818" points="502,650.2109,492,654.2109,502,658.2109,498,654.2109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="496" x2="719" y1="654.2109" y2="654.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="508" y="649.4688">R&#233;ponse (204 No Content)</text><polygon fill="#181818" points="54,679.5215,44,683.5215,54,687.5215,50,683.5215" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="48" x2="485" y1="683.5215" y2="683.5215"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="60" y="678.7793">Transmet la r&#233;ponse</text><!--SRC=[bLJDRjD04BxxAKQ-q4WqRYguM5KaMb9GMqZKHEqbbwqzf4ktksP_GWJYNJZMl8PVZ5ad8VRM0U6BdTsPRx-VsLXk1SAvS2l8NxnnzXwbvPzunYnN4j3wrIohdWnCjB9LkQZAA6APLHhE1AVYABfJAuYdg9VeD4mBpUK2JfMoSGHGC6rvnWicBNZqCoMjLaAWXfEJQpHsjp0S1lKNNwr7vHbIxUQhgyZZddDXQyprnxCoulFmzxDHva1AecYXbIjWSiyCmW1I24qXPDXeXyDXg2g5oNWwWuGLF66qbGYru78k3vn1_P8u6TEh4SX3lcGM0u1wBy3iEkM62PuZ23H0xveUwJHxsXjMfl2kAcNrf16S1AiUKBRvx6hhzKRhOHUHYzjPNPVZFeIG3g5ix4lXkYeB9SdfW-EZ8nXVzkRoEyGrgpY5UEMVVhyVmu_maC0sYY-Ag186h-6HIsV9c48u0vRf76YZ7Uon3tOzrzLFCW91ep7AQP9PR0STWwZRivR2sz7LQ3PQPxqS97SqOoOPpELxP3dgzUGepR_LOvF2AJ9DVLjDprpVOM-DRvmMXlWd__-FC9HHGwtl-_Zo7rdkPTP2_43_6sJhP_BJCyme9bmH614sLPavpSdWRgZWegPmnRYXmFp5eT-2KL1VNFNBObjokw_U2w2wm6UQSMecLEEAme_0zeA7pHqgcxFx2ZugyFKqAhtGmmvkWUxcbI1EqZoIWrxhveYEL1hJGhF_6m00]--></g></svg></div></section><section class="chapter"><h2 id="5-le-code-de-s-curit-complet" data-toc="5-le-code-de-s-curit-complet">5. Le code de s&eacute;curit&eacute; complet</h2><p id="-lrg8ux_111">Pour rendre le syst&egrave;me fonctionnel, nous avons besoin de trois composants principaux :</p><ol class="list _decimal" id="-lrg8ux_112" type="1"><li class="list__item" id="-lrg8ux_118"><p id="-lrg8ux_121"><span class="control" id="-lrg8ux_122"><code class="code" id="-lrg8ux_123">JwtService</code></span>: Une classe de service responsable de la cr&eacute;ation et de la validation des tokens.</p></li><li class="list__item" id="-lrg8ux_119"><p id="-lrg8ux_124"><span class="control" id="-lrg8ux_125"><code class="code" id="-lrg8ux_126">JwtAuthFilter</code></span>: Un filtre qui intercepte chaque requ&ecirc;te, extrait le token et met &agrave; jour le contexte de s&eacute;curit&eacute;.</p></li><li class="list__item" id="-lrg8ux_120"><p id="-lrg8ux_127"><span class="control" id="-lrg8ux_128"><code class="code" id="-lrg8ux_130">AuthController</code></span>: Un contr&ocirc;leur avec un endpoint <code class="code" id="-lrg8ux_129">/login</code> pour d&eacute;marrer le processus.</p></li></ol><section class="chapter"><h3 id="5-1-configuration-des-propri-t-s-jwt" data-toc="5-1-configuration-des-propri-t-s-jwt">5.1. Configuration des Propri&eacute;t&eacute;s JWT</h3><p id="-lrg8ux_131">D'abord, ajoutons les propri&eacute;t&eacute;s de configuration pour notre token dans <code class="code" id="-lrg8ux_135">application.properties</code>.</p><div class="code-block" data-lang="properties">
# -- Sécurité de l'API avec JWT --
# Clé secrète pour signer les tokens. DOIT être longue et complexe en production.
# Pour la générer, on peut utiliser un encodage Base64 d'une chaîne aléatoire.
bibliotech.security.jwt.secret-key=bXktMzJtYl9zZWNyZXQtYmlibGlvdGVjaC1hcGktc2VjcmV0LWtleS1pcy1zdXBlci1sb25nLWFuZC1zZWN1cmU=
# Durée de validité du token en millisecondes (ici, 1 heure)
bibliotech.security.jwt.expiration-time=3600000
</div><aside class="prompt" data-type="warning" data-title="Clé Secrète en Production" id="-lrg8ux_133"><p id="-lrg8ux_136">La cl&eacute; secr&egrave;te est le bien le plus pr&eacute;cieux de votre API. Ne la stockez jamais en clair dans votre code ou dans un fichier de configuration public. Utilisez des variables d'environnement ou un service de gestion des secrets comme HashiCorp Vault ou AWS Secrets Manager.</p></aside></section><section class="chapter"><h3 id="5-2-le-service-jwt-jwtservice-java" data-toc="5-2-le-service-jwt-jwtservice-java">5.2. Le Service JWT (<code class="code" id="-lrg8ux_141">JwtService.java</code>)</h3><p id="-lrg8ux_138">Ce service encapsule toute la logique de manipulation des tokens.</p><section class="procedure-steps"><h3 id="-lrg8ux_139" data-toc="-lrg8ux_139">Création de JwtService.java</h3><p>Cr&eacute;ez cette classe dans le package `fr.formation.spring.bibliotech.security`. </p><div class="code-block" data-lang="java">
package fr.formation.spring.bibliotech.security;

import io.jsonwebtoken.Claims;
import io.jsonwebtoken.Jwts;
import io.jsonwebtoken.SignatureAlgorithm;
import io.jsonwebtoken.io.Decoders;
import io.jsonwebtoken.security.Keys;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.security.core.GrantedAuthority;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.stereotype.Service;

import java.security.Key;
import java.util.Date;
import java.util.HashMap;
import java.util.Map;
import java.util.function.Function;
import java.util.stream.Collectors;

@Service
public class JwtService {

    @Value(&quot;${bibliotech.security.jwt.secret-key}&quot;)
    private String secretKey;

    @Value(&quot;${bibliotech.security.jwt.expiration-time}&quot;)
    private long jwtExpiration;

    // Extrait le nom d'utilisateur (subject) du token
    public String extractUsername(String token) {
        return extractClaim(token, Claims::getSubject);
    }

    // Génère un token à partir des détails de l'utilisateur
    public String generateToken(UserDetails userDetails) {
        return generateToken(new HashMap&lt;&gt;(), userDetails);
    }

    // Génère un token avec des claims supplémentaires
    public String generateToken(Map&lt;String, Object&gt; extraClaims, UserDetails userDetails) {
        // Ajoute les rôles de l'utilisateur dans les claims du token
        extraClaims.put(&quot;roles&quot;, userDetails.getAuthorities().stream()
                .map(GrantedAuthority::getAuthority).collect(Collectors.toList()));

        return Jwts.builder()
                .setClaims(extraClaims)
                .setSubject(userDetails.getUsername())
                .setIssuedAt(new Date(System.currentTimeMillis()))
                .setExpiration(new Date(System.currentTimeMillis() + jwtExpiration))
                .signWith(getSignInKey(), SignatureAlgorithm.HS256)
                .compact();
    }

    // Vérifie si le token est valide pour un utilisateur donné
    public boolean isTokenValid(String token, UserDetails userDetails) {
        final String username = extractUsername(token);
        return (username.equals(userDetails.getUsername())) &amp;&amp; !isTokenExpired(token);
    }

    // Vérifie si le token est expiré
    private boolean isTokenExpired(String token) {
        return extractExpiration(token).before(new Date());
    }

    // Extrait la date d'expiration du token
    private Date extractExpiration(String token) {
        return extractClaim(token, Claims::getExpiration);
    }

    // Méthode générique pour extraire un claim spécifique
    public &lt;T&gt; T extractClaim(String token, Function&lt;Claims, T&gt; claimsResolver) {
        final Claims claims = extractAllClaims(token);
        return claimsResolver.apply(claims);
    }

    // Extrait tous les claims du token
    private Claims extractAllClaims(String token) {
        return Jwts.parserBuilder()
                .setSigningKey(getSignInKey())
                .build()
                .parseClaimsJws(token)
                .getBody();
    }

    // Récupère la clé de signature à partir de la clé secrète en Base64
    private Key getSignInKey() {
        byte[] keyBytes = Decoders.BASE64.decode(secretKey);
        return Keys.hmacShaKeyFor(keyBytes);
    }
}
</div><ol class="list _decimal"></ol></section></section><section class="chapter"><h3 id="5-3-le-filtre-d-authentification-jwt-jwtauthfilter-java" data-toc="5-3-le-filtre-d-authentification-jwt-jwtauthfilter-java">5.3. Le Filtre d'Authentification JWT (<code class="code" id="-lrg8ux_147">JwtAuthFilter.java</code>)</h3><p id="-lrg8ux_144">Ce filtre s'ex&eacute;cute une fois par requ&ecirc;te pour valider le token et &eacute;tablir l'identit&eacute; de l'utilisateur.</p><section class="procedure-steps"><h3 id="-lrg8ux_145" data-toc="-lrg8ux_145">Création de JwtAuthFilter.java</h3><p>Cr&eacute;ez cette classe dans le package `fr.formation.spring.bibliotech.security`. </p><div class="code-block" data-lang="java">
package fr.formation.spring.bibliotech.security;

import jakarta.servlet.FilterChain;
import jakarta.servlet.ServletException;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import org.springframework.lang.NonNull;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.web.authentication.WebAuthenticationDetailsSource;
import org.springframework.stereotype.Component;
import org.springframework.web.filter.OncePerRequestFilter;

import java.io.IOException;

@Component
public class JwtAuthFilter extends OncePerRequestFilter {

    private final JwtService jwtService;
    private final UserDetailsService userDetailsService;

    public JwtAuthFilter(JwtService jwtService, UserDetailsService userDetailsService) {
        this.jwtService = jwtService;
        this.userDetailsService = userDetailsService;
    }

    @Override
    protected void doFilterInternal(
            @NonNull HttpServletRequest request,
            @NonNull HttpServletResponse response,
            @NonNull FilterChain filterChain
    ) throws ServletException, IOException {

        final String authHeader = request.getHeader(&quot;Authorization&quot;);
        final String jwt;
        final String username;

        // Si l'en-tête est absent ou ne commence pas par &quot;Bearer &quot;, on passe au filtre suivant
        if (authHeader == null || !authHeader.startsWith(&quot;Bearer &quot;)) {
            filterChain.doFilter(request, response);
            return;
        }

        // Extrait le token (après &quot;Bearer &quot;)
        jwt = authHeader.substring(7);
        username = jwtService.extractUsername(jwt);

        // Si on a un username mais que l'utilisateur n'est pas encore authentifié
        if (username != null &amp;&amp; SecurityContextHolder.getContext().getAuthentication() == null) {
            UserDetails userDetails = this.userDetailsService.loadUserByUsername(username);

            // Si le token est valide
            if (jwtService.isTokenValid(jwt, userDetails)) {
                // On crée un objet d'authentification
                UsernamePasswordAuthenticationToken authToken = new UsernamePasswordAuthenticationToken(
                        userDetails,
                        null, // On ne stocke pas les mots de passe
                        userDetails.getAuthorities()
                );
                authToken.setDetails(
                        new WebAuthenticationDetailsSource().buildDetails(request)
                );
                // On met à jour le SecurityContextHolder
                SecurityContextHolder.getContext().setAuthentication(authToken);
            }
        }
        // On continue la chaîne des filtres
        filterChain.doFilter(request, response);
    }
}
</div><ol class="list _decimal"></ol></section></section><section class="chapter"><h3 id="5-4-le-contr-leur-d-authentification-authcontroller-java" data-toc="5-4-le-contr-leur-d-authentification-authcontroller-java">5.4. Le Contr&ocirc;leur d'Authentification (<code class="code" id="-lrg8ux_153">AuthController.java</code>)</h3><p id="-lrg8ux_150">Ce contr&ocirc;leur fournit l'endpoint <code class="code" id="-lrg8ux_154">/login</code> public pour que les utilisateurs puissent obtenir un token.</p><section class="procedure-steps"><h3 id="-lrg8ux_151" data-toc="-lrg8ux_151">Création de AuthController.java</h3><p>Cr&eacute;ez un nouveau package `fr.formation.spring.bibliotech.api.auth` et placez-y cette classe et ses DTOs. </p><p id="-lrg8ux_155"><span class="control" id="-lrg8ux_160">DTOs pour l'authentification</span></p><div class="code-block" data-lang="java">
// AuthRequest.java
package fr.formation.spring.bibliotech.api.auth;

import lombok.Data;

@Data
public class AuthRequest {
    private String username;
    private String password;
}
</div><div class="code-block" data-lang="java">
// AuthResponse.java
package fr.formation.spring.bibliotech.api.auth;

import lombok.AllArgsConstructor;
import lombok.Data;

@Data
@AllArgsConstructor
public class AuthResponse {
    private String token;
}
</div><p id="-lrg8ux_158"><span class="control" id="-lrg8ux_161">Le contr&ocirc;leur</span></p><div class="code-block" data-lang="java">
// AuthController.java
package fr.formation.spring.bibliotech.api.auth;

import fr.formation.spring.bibliotech.security.JwtService;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
@RequestMapping(&quot;/api/auth&quot;)
public class AuthController {

    private final AuthenticationManager authenticationManager;
    private final JwtService jwtService;

    public AuthController(AuthenticationManager authenticationManager, JwtService jwtService) {
        this.authenticationManager = authenticationManager;
        this.jwtService = jwtService;
    }

    @PostMapping(&quot;/login&quot;)
    public AuthResponse login(@RequestBody AuthRequest request) {
        // Spring Security s'occupe de vérifier les identifiants
        Authentication authentication = authenticationManager.authenticate(
                new UsernamePasswordAuthenticationToken(request.getUsername(), request.getPassword())
        );
        // Si l'authentification réussit, on génère et retourne le token
        UserDetails user = (UserDetails) authentication.getPrincipal();
        String token = jwtService.generateToken(user);
        return new AuthResponse(token);
    }
}
</div><ol class="list _decimal"></ol></section></section><section class="chapter"><h3 id="5-5-derni-re-tape-mettre-jour-securityconfig" data-toc="5-5-derni-re-tape-mettre-jour-securityconfig">5.5. Derni&egrave;re &Eacute;tape : Mettre &agrave; Jour <code class="code" id="-lrg8ux_166">SecurityConfig</code></h3><p id="-lrg8ux_163">Il nous reste &agrave; assembler toutes les pi&egrave;ces dans notre configuration de s&eacute;curit&eacute;.</p><section class="procedure-steps"><h3 id="-lrg8ux_164" data-toc="-lrg8ux_164">Mise à jour finale de SecurityConfig.java</h3><div class="code-block" data-lang="java">
package fr.formation.spring.bibliotech.config;

import fr.formation.spring.bibliotech.security.JwtAuthFilter;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.http.HttpMethod;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.config.annotation.authentication.configuration.AuthenticationConfiguration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.http.SessionCreationPolicy;
import org.springframework.security.core.userdetails.User;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.security.provisioning.InMemoryUserDetailsManager;
import org.springframework.security.web.SecurityFilterChain;
import org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;

@Configuration
@EnableWebSecurity
public class SecurityConfig {

    private final JwtAuthFilter jwtAuthFilter;

    public SecurityConfig(JwtAuthFilter jwtAuthFilter) {
        this.jwtAuthFilter = jwtAuthFilter;
    }

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
                .csrf(csrf -&gt; csrf.disable())
                .sessionManagement(session -&gt;
                        session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))

                // On ajoute notre filtre JWT avant le filtre de base de Spring
                .addFilterBefore(jwtAuthFilter, UsernamePasswordAuthenticationFilter.class)

                .authorizeHttpRequests(auth -&gt; auth
                        // Endpoints publics
                        .requestMatchers(&quot;/swagger-ui/**&quot;, &quot;/v3/api-docs/**&quot;).permitAll()
                        .requestMatchers(&quot;/h2-console/**&quot;).permitAll()
                        .requestMatchers(&quot;/api/auth/login&quot;).permitAll()

                        // Les requêtes GET sont publiques
                        .requestMatchers(HttpMethod.GET, &quot;/api/v1/**&quot;).permitAll()

                        // Seuls les admins peuvent faire des requêtes d'écriture
                        .requestMatchers(HttpMethod.POST, &quot;/api/v1/**&quot;).hasRole(&quot;ADMIN&quot;)
                        .requestMatchers(HttpMethod.PUT, &quot;/api/v1/**&quot;).hasRole(&quot;ADMIN&quot;)
                        .requestMatchers(HttpMethod.DELETE, &quot;/api/v1/**&quot;).hasRole(&quot;ADMIN&quot;)

                        // Toute autre requête doit être authentifiée
                        .anyRequest().authenticated()
                );

        http.headers(headers -&gt; headers.frameOptions(frame -&gt; frame.sameOrigin()));

        return http.build();
    }

    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }

    @Bean
    public UserDetailsService userDetailsService() {
        UserDetails admin = User.builder()
                .username(&quot;admin&quot;)
                .password(passwordEncoder().encode(&quot;password123&quot;))
                .roles(&quot;ADMIN&quot;, &quot;USER&quot;)
                .build();
        UserDetails user = User.builder()
                .username(&quot;user&quot;)
                .password(passwordEncoder().encode(&quot;password&quot;))
                .roles(&quot;USER&quot;)
                .build();
        return new InMemoryUserDetailsManager(admin, user);
    }

    // On expose l'AuthenticationManager comme un Bean pour pouvoir l'injecter
    @Bean
    public AuthenticationManager authenticationManager(AuthenticationConfiguration config) throws Exception {
        return config.getAuthenticationManager();
    }

}

</div><ol class="list _decimal"></ol></section><p id="-lrg8ux_165">Vous disposez maintenant d'un syst&egrave;me de s&eacute;curit&eacute; JWT complet, fonctionnel et robuste. Les utilisateurs peuvent s'identifier via <code class="code" id="-lrg8ux_168">/api/auth/login</code>, et seuls les administrateurs authentifi&eacute;s peuvent modifier les donn&eacute;es.</p></section></section><section class="chapter"><h2 id="exercice-15-mettre-en-place-une-r-gle-de-s-curit" data-toc="exercice-15-mettre-en-place-une-r-gle-de-s-curit">Exercice 15 : Mettre en Place une R&egrave;gle de S&eacute;curit&eacute;</h2><p id="-lrg8ux_169">Parfait ! C'est une excellente id&eacute;e de transformer la mise en place de la s&eacute;curit&eacute; en un exercice interactif. Voici un nouvel exercice 15, con&ccedil;u pour &ecirc;tre r&eacute;alis&eacute; <span class="emphasis" id="-lrg8ux_171">apr&egrave;s</span> que le code JWT complet ait &eacute;t&eacute; fourni et int&eacute;gr&eacute;. Il se concentre sur l'affinage des r&egrave;gles de s&eacute;curit&eacute;, une t&acirc;che tr&egrave;s courante en entreprise.</p></section><section class="chapter"><h2 id="exercice-15-affiner-les-autorisations-par-r-le" data-toc="exercice-15-affiner-les-autorisations-par-r-le">Exercice 15 : Affiner les Autorisations par R&ocirc;le</h2><p id="-lrg8ux_172">Notre syst&egrave;me de s&eacute;curit&eacute; JWT est en place. Actuellement, les r&egrave;gles sont assez simples : les anonymes peuvent lire (<code class="code" id="-lrg8ux_181">GET</code>), et seuls les administrateurs peuvent &eacute;crire (<code class="code" id="-lrg8ux_182">POST</code>, <code class="code" id="-lrg8ux_183">PUT</code>, <code class="code" id="-lrg8ux_184">DELETE</code>). C'est un bon d&eacute;but, mais dans la r&eacute;alit&eacute;, les droits sont souvent plus granulaires.</p><p id="-lrg8ux_173">Imaginons une nouvelle exigence pour &quot;BiblioTech&quot; :</p><ul class="list _bullet" id="-lrg8ux_174"><li class="list__item" id="-lrg8ux_185"><p id="-lrg8ux_187">Un utilisateur normal (ayant le r&ocirc;le <code class="code" id="-lrg8ux_188">USER</code>) doit pouvoir ajouter un livre &agrave; la biblioth&egrave;que (peut-&ecirc;tre comme une suggestion ou une contribution).</p></li><li class="list__item" id="-lrg8ux_186"><p id="-lrg8ux_189">Cependant, seul un administrateur (r&ocirc;le <code class="code" id="-lrg8ux_190">ADMIN</code>) a le droit de modifier un livre existant ou de le supprimer.</p></li></ul><p id="-lrg8ux_175">Votre mission est d'adapter notre configuration de s&eacute;curit&eacute; pour refl&eacute;ter ces nouvelles r&egrave;gles plus fines.</p><p id="-lrg8ux_176"><span class="control" id="-lrg8ux_191">&Eacute;nonc&eacute; :</span></p><ol class="list _decimal" id="-lrg8ux_177" type="1"><li class="list__item" id="-lrg8ux_192"><p id="-lrg8ux_193"><span class="control" id="-lrg8ux_194">Analysez le besoin</span>: Identifiez quels endpoints du <code class="code" id="-lrg8ux_195">BookController</code> sont concern&eacute;s et quels r&ocirc;les doivent y avoir acc&egrave;s.</p></li></ol><ul class="list _bullet" id="-lrg8ux_178"><li class="list__item" id="-lrg8ux_196"><p id="-lrg8ux_200"><code class="code" id="-lrg8ux_201">GET /api/v1/books/**</code>: Doit rester public.</p></li><li class="list__item" id="-lrg8ux_197"><p id="-lrg8ux_202"><code class="code" id="-lrg8ux_203">POST /api/v1/books</code>: Doit &ecirc;tre accessible aux <code class="code" id="-lrg8ux_204">USER</code> et aux <code class="code" id="-lrg8ux_205">ADMIN</code>.</p></li><li class="list__item" id="-lrg8ux_198"><p id="-lrg8ux_206"><code class="code" id="-lrg8ux_207">PUT /api/v1/books/{id}</code>: Doit rester accessible uniquement aux <code class="code" id="-lrg8ux_208">ADMIN</code>.</p></li><li class="list__item" id="-lrg8ux_199"><p id="-lrg8ux_209"><code class="code" id="-lrg8ux_210">DELETE /api/v1/books/{id}</code>: Doit rester accessible uniquement aux <code class="code" id="-lrg8ux_211">ADMIN</code>.</p></li></ul><ol class="list _decimal" id="-lrg8ux_179" type="1" start="2"><li class="list__item" id="-lrg8ux_212"><p id="-lrg8ux_215"><span class="control" id="-lrg8ux_216">Modifiez la <code class="code" id="-lrg8ux_219">SecurityConfig</code></span>: Reprenez votre fichier <code class="code" id="-lrg8ux_217">SecurityConfig.java</code> et modifiez la section <code class="code" id="-lrg8ux_218">.authorizeHttpRequests()</code>. Vous devrez d&eacute;composer les r&egrave;gles actuelles pour les rendre plus sp&eacute;cifiques.</p></li><li class="list__item" id="-lrg8ux_213"><p id="-lrg8ux_220"><span class="control" id="-lrg8ux_221">Utilisez <code class="code" id="-lrg8ux_225">hasAnyRole()</code></span>: Pour l'endpoint de cr&eacute;ation (<code class="code" id="-lrg8ux_222">POST</code>), vous devrez utiliser une nouvelle m&eacute;thode de Spring Security, <code class="code" id="-lrg8ux_223">hasAnyRole(&quot;USER&quot;, &quot;ADMIN&quot;)</code>, qui autorise l'acc&egrave;s si l'utilisateur poss&egrave;de <span class="emphasis" id="-lrg8ux_224">au moins un</span> des r&ocirc;les list&eacute;s.</p></li><li class="list__item" id="-lrg8ux_214"><p id="-lrg8ux_226"><span class="control" id="-lrg8ux_227">Testez chaque cas d'usage</span> avec votre client HTTP :</p></li></ol><ul class="list _bullet" id="-lrg8ux_180"><li class="list__item" id="-lrg8ux_228"><p id="-lrg8ux_233"><span class="control" id="-lrg8ux_234">Login en tant que <code class="code" id="-lrg8ux_237">user</code></span>: <code class="code" id="-lrg8ux_235">POST /api/auth/login</code> avec les identifiants de <code class="code" id="-lrg8ux_236">user</code>. Copiez le token obtenu.</p></li><li class="list__item" id="-lrg8ux_229"><p id="-lrg8ux_238"><span class="control" id="-lrg8ux_239">Test de cr&eacute;ation (<code class="code" id="-lrg8ux_243">POST</code>)</span>: Envoyez une requ&ecirc;te <code class="code" id="-lrg8ux_240">POST /api/v1/books</code> avec le token du <code class="code" id="-lrg8ux_241">user</code>. Elle doit r&eacute;ussir (<code class="code" id="-lrg8ux_242">201 Created</code>).</p></li><li class="list__item" id="-lrg8ux_230"><p id="-lrg8ux_244"><span class="control" id="-lrg8ux_245">Test de suppression (<code class="code" id="-lrg8ux_249">DELETE</code>)</span>: Envoyez une requ&ecirc;te <code class="code" id="-lrg8ux_246">DELETE /api/v1/books/{id}</code> avec le token du <code class="code" id="-lrg8ux_247">user</code>. Elle doit &eacute;chouer (<code class="code" id="-lrg8ux_248">403 Forbidden</code>).</p></li><li class="list__item" id="-lrg8ux_231"><p id="-lrg8ux_250"><span class="control" id="-lrg8ux_251">Login en tant qu' <code class="code" id="-lrg8ux_254">admin</code></span>: <code class="code" id="-lrg8ux_252">POST /api/auth/login</code> avec les identifiants de <code class="code" id="-lrg8ux_253">admin</code>. Copiez le nouveau token.</p></li><li class="list__item" id="-lrg8ux_232"><p id="-lrg8ux_255"><span class="control" id="-lrg8ux_256">Test de suppression (<code class="code" id="-lrg8ux_260">DELETE</code>)</span>: Renvoyez la m&ecirc;me requ&ecirc;te <code class="code" id="-lrg8ux_257">DELETE</code> avec le token de <code class="code" id="-lrg8ux_258">admin</code>. Elle doit maintenant r&eacute;ussir (<code class="code" id="-lrg8ux_259">204 No Content</code>).</p></li></ul></section><section class="chapter"><div class="collapse"><div class="collapse__title"><h2 id="correction-exercice-15" data-toc="correction-exercice-15">Correction exercice 15</h2></div><div class="collapse__content"><p id="-lrg8ux_261"><span class="control" id="-lrg8ux_266">Solution dans <code class="code" id="-lrg8ux_267">SecurityConfig.java</code></span></p><p id="-lrg8ux_262">La cl&eacute; est de r&eacute;organiser l'ordre et la sp&eacute;cificit&eacute; des <code class="code" id="-lrg8ux_268">requestMatchers</code>. Les r&egrave;gles les plus sp&eacute;cifiques doivent &ecirc;tre d&eacute;clar&eacute;es avant les plus g&eacute;n&eacute;rales.</p><div class="code-block" data-lang="java">
// package fr.formation.spring.bibliotech.config;
// ... imports

@Configuration
@EnableWebSecurity
public class SecurityConfig {

    private final JwtAuthFilter jwtAuthFilter;

    public SecurityConfig(JwtAuthFilter jwtAuthFilter) {
        this.jwtAuthFilter = jwtAuthFilter;
    }

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http
                .csrf(csrf -&gt; csrf.disable())
                .sessionManagement(session -&gt;
                        session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))

                .addFilterBefore(jwtAuthFilter, UsernamePasswordAuthenticationFilter.class)

                .authorizeHttpRequests(auth -&gt; auth
                        // --- Endpoints Publics ---
                        .requestMatchers(&quot;/swagger-ui/**&quot;, &quot;/v3/api-docs/**&quot;).permitAll()
                        .requestMatchers(&quot;/h2-console/**&quot;).permitAll()
                        .requestMatchers(&quot;/api/auth/login&quot;).permitAll()
                        .requestMatchers(HttpMethod.GET, &quot;/api/v1/**&quot;).permitAll() // Lecture publique

                        // --- Règles Spécifiques pour les Livres ---
                        // Seuls les admins peuvent modifier ou supprimer un livre
                        .requestMatchers(HttpMethod.PUT, &quot;/api/v1/books/**&quot;).hasRole(&quot;ADMIN&quot;)
                        .requestMatchers(HttpMethod.DELETE, &quot;/api/v1/books/**&quot;).hasRole(&quot;ADMIN&quot;)
                        // Les admins ET les users peuvent créer un livre
                        .requestMatchers(HttpMethod.POST, &quot;/api/v1/books&quot;).hasAnyRole(&quot;USER&quot;, &quot;ADMIN&quot;)

                        // --- Règles pour les Auteurs (restent inchangées pour l'exercice) ---
                        .requestMatchers(HttpMethod.POST, &quot;/api/v1/authors&quot;).hasRole(&quot;ADMIN&quot;)
                        .requestMatchers(HttpMethod.PUT, &quot;/api/v1/authors/**&quot;).hasRole(&quot;ADMIN&quot;)
                        .requestMatchers(HttpMethod.DELETE, &quot;/api/v1/authors/**&quot;).hasRole(&quot;ADMIN&quot;)

                        // --- Règle par défaut pour tout le reste ---
                        // Toute autre requête (non définie ci-dessus) doit être authentifiée.
                        .anyRequest().authenticated()
                );

        http.headers(headers -&gt; headers.frameOptions(frame -&gt; frame.sameOrigin()));

        return http.build();
    }

    // ... reste de la classe (PasswordEncoder, UserDetailsService, AuthenticationManager)
}
</div><p id="-lrg8ux_264"><span class="control" id="-lrg8ux_269">Logique des tests <code class="code" id="-lrg8ux_270">requests.http</code></span></p><div class="code-block" data-lang="http">
### 1. S'authentifier en tant que simple utilisateur
# @name loginUser
POST http://localhost:8080/api/auth/login
Content-Type: application/json

{
  &quot;username&quot;: &quot;user&quot;,
  &quot;password&quot;: &quot;password&quot;
}

# Récupérer le token de la réponse, par exemple : &quot;eyJhbGciOiJI...&quot;
# Stocker ce token dans une variable
#!! { &quot;user_token&quot;: &quot;{{loginUser.response.body.token}}&quot; }

### 2. Essayer de créer un livre en tant que USER (doit réussir)
POST http://localhost:8080/api/v1/books
Content-Type: application/json
Authorization: Bearer {{user_token}}

{
  &quot;title&quot;: &quot;Livre Suggéré par un Utilisateur&quot;,
  &quot;isbn&quot;: &quot;978-3-16-148410-0&quot;,
  &quot;publicationDate&quot;: &quot;2024-01-01&quot;,
  &quot;authorIds&quot;: [1]
}

### 3. Essayer de supprimer un livre en tant que USER (doit échouer avec 403)
DELETE http://localhost:8080/api/v1/books/1
Authorization: Bearer {{user_token}}

### 4. S'authentifier en tant qu'administrateur
# @name loginAdmin
POST http://localhost:8080/api/auth/login
Content-Type: application/json

{
  &quot;username&quot;: &quot;admin&quot;,
  &quot;password&quot;: &quot;password123&quot;
}

#!! { &quot;admin_token&quot;: &quot;{{loginAdmin.response.body.token}}&quot; }

### 5. Essayer de supprimer un livre en tant qu'ADMIN (doit réussir)
DELETE http://localhost:8080/api/v1/books/1
Authorization: Bearer {{admin_token}}
</div></div></div></section><section class="chapter"><h2 id="conclusion" data-toc="conclusion">Conclusion</h2><p id="-lrg8ux_271">Vous avez effleur&eacute; le framework de s&eacute;curit&eacute; le plus puissant et le plus complet de l'&eacute;cosyst&egrave;me Java. L'int&eacute;gration de la s&eacute;curit&eacute; avec JWT est une &eacute;tape complexe mais indispensable pour la majorit&eacute; des API modernes. Vous comprenez maintenant l'architecture de base : un endpoint pour s'authentifier, et un filtre pour v&eacute;rifier l'identit&eacute; sur chaque requ&ecirc;te prot&eacute;g&eacute;e.</p><p id="-lrg8ux_272">M&ecirc;me si nous n'avons pas &eacute;crit chaque ligne de code du flux JWT, vous avez en main le plan d'architecte. Vous &ecirc;tes pr&ecirc;t &agrave; approfondir le sujet en impl&eacute;mentant les services et filtres n&eacute;cessaires, ce qui constitue une comp&eacute;tence cl&eacute; pour tout d&eacute;veloppeur back-end senior.</p></section><div class="last-modified">29 juin 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="005-04-secure-api.html" class="navigation-links__prev">Chapitre 5 : La S&eacute;curisation par Cl&eacute; d'API - Prot&eacute;ger vos Endpoints</a><a href="004-00-documentation.html" class="navigation-links__next">Chapitre 6 : Documentation des API avec OpenAPI - L'Essentiel</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>